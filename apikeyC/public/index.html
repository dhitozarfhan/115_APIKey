<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Key Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; font-family: 'Inter', sans-serif;
      display: flex; align-items: center; justify-content: center;
      min-height: 100vh; background: linear-gradient(135deg, #4a00e0, #8e2de2);
      color: #fff;
    }
    .card {
      background: rgba(255,255,255,0.1); padding: 30px; border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.4); text-align: center;
      width: 380px;
    }
    textarea {
      width: 100%; min-height: 90px; border: none; border-radius: 10px;
      padding: 12px; font-family: monospace; resize: none;
      font-size: 14px; margin-top: 12px;
    }
    button {
      padding: 10px 18px; border: none; border-radius: 10px;
      font-weight: 600; cursor: pointer;
      background: linear-gradient(90deg, #ff7eb3, #65d6ff);
      color: #08122a; margin: 4px;
    }
    .ghost {background: transparent; color: white; border: 1px solid rgba(255,255,255,0.3);}
  </style>
</head>
<body>
  <div class="card">
    <h2>üîë API Key Generator</h2>
    <p>Tekan tombol untuk membuat dan menyimpan API key.</p>

    <div>
      <button id="generateLocal">Generate Lokal</button>
      <button id="generateServer">Generate & Simpan</button>
      <button id="verifyKey" class="ghost">Verifikasi</button>
    </div>

    <textarea id="output" readonly placeholder="API key akan muncul di sini..."></textarea>
  </div>

  <script>
    const out = document.getElementById('output');
    const localBtn = document.getElementById('generateLocal');
    const serverBtn = document.getElementById('generateServer');
    const verifyBtn = document.getElementById('verifyKey');

    // Generate API Key di client
    localBtn.onclick = () => {
      const key = generateKey(32);
      out.value = key;
    }

    // Generate API Key di server
    serverBtn.onclick = async () => {
      const res = await fetch('/api/create', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({})
      });
      const data = await res.json();
      out.value = data.key || 'Gagal membuat API key.';
    }

    // Verifikasi key
    verifyBtn.onclick = async () => {
      const key = out.value.trim();
      if(!key) return alert('Masukkan API key dulu.');
      const res = await fetch('/api/verify', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({key})
      });
      const data = await res.json();
      alert(data.valid ? '‚úÖ Key valid!' : '‚ùå Key tidak terdaftar.');
    }

    function generateKey(length){
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      for(let i=0; i<length; i++) result += chars.charAt(Math.floor(Math.random()*chars.length));
      return result;
    }
  </script>
</body>
</html>
